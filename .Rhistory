geom_smooth(se = FALSE, colour = "black")
ggplot(team_statistics, aes(x = fitted, y = res))+
geom_point(colour = "red")+
geom_hline(yintercept = 0, colour = "red", linetype = "dashed") +
geom_smooth(se = FALSE, colour = "black")
ggplot(team_statistics, aes(x = fitted, y = res))+
geom_point(colour = "blue")+
geom_hline(yintercept = 0, colour = "red", linetype = "dashed") +
geom_smooth(se = FALSE, colour = "black")
#8. Normality
ggplot(data =NULL, aes(x= res))+
geom_histogram( colour = "red", fill = "black", binwidth = 1.5)+
theme(panel.background = element_rect(fill = 'red'))
#8. Normality
ggplot(data =NULL, aes(x= res))+
geom_histogram( colour = "red", fill = "black", binwidth = 1.5)
#8. Normality
ggplot(data =NULL, aes(x= res))+
geom_histogram( colour = "Black", fill = "Blue", binwidth = 1.5)
ggplot(data = NULL, aes(sample =res))+
theme(panel.background = element_rect(fill = 'red'))+
stat_qq() + stat_qq_line()
ggplot(data = NULL, aes(sample =res))+
stat_qq() + stat_qq_line()
#9. Multicollinearity
pairs(formula = ~ PTS_PG + REB_PG + AST_PG + STL_PG +
BLK_PG + TOV_PG, data = team_statistics)
car::vif(fit)
sqrt(car::vif(fit))
#####MODEL TESTING
team_statistics<- mutate(team_statistics,
exp_NRtg_PG = predict(fit,
newdata = team_statistics))
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.25, cex = 2) +
theme(panel.background = element_rect(fill = 'red'))+
geom_abline(linetype = "solid", colour = "white") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.25, cex = 2) +
geom_abline(linetype = "solid", colour = "white") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.25, cex = 2) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1, cex = 2) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 4) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 1) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 1.5) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 1.75) +
geom_abline(linetype = "solid", colour = "black") #Reference Line for 100% Prediction
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_per_game, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "dashed", colour = "blue")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "dashed", colour = "blue")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "dashed", colour = "blue")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "dashed", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black")
##exp NRgt ~ NRgt
ggplot(team_statistics, aes(exp_NRtg_PG, NRtg, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 1.75) +
geom_abline(linetype = "solid", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
theme(panel.background = element_rect(fill = 'red'))+
geom_abline(linetype = "dashed", colour = "blue")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "dashed", colour = "blue")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = -1.5, cex = 1.75) +
geom_abline(linetype = "solid", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3, cex = 1.75) +
geom_abline(linetype = "solid", colour = "black")
#exp NRgt ~ wins
ggplot(team_statistics, aes(x = W, y = exp_NRtg_PG, label = Team)) +
geom_point(colour = "black") +
geom_text(nudge_x = 3.5, cex = 2) +
geom_abline(linetype = "solid", colour = "black")
####CREATING PLAYER METRICS
##Making a Mintues per Game Metric
min_PG <- team_statistics %>%
group_by(Team) %>%
summarise(min_per_game = (MP/G)) %>%
pull(min_PG) %>%
mean
####CREATING PLAYER METRICS
##Making a Mintues per Game Metric
min_PG <- team_statistics %>%
group_by(Team) %>%
summarise(min_PG = (MP/G)) %>%
pull(min_PG) %>%
mean
min_PG
####CREATING PLAYER METRICS
##Making a Mintues per Game Metric
min_PG <- team_statistics %>%
group_by(Team) %>%
summarise(min_PG = (MP/G))
min_PG
####CREATING PLAYER METRICS
##Making a Mintues per Game Metric
min_PG <- team_statistics %>%
group_by(Team) %>%
summarise(min_PG = (MP/G)) %>%
pull(min_PG) %>%
mean
min_PG
##
players <- statistics %>%
group_by(player_name) %>%
summarise(G = sum(MP) / min_PG,
PTS_PG = sum(PTS) / G,
REB_PG = sum(TRB) / G,
AST_PG= sum(AST) / G,
STL_PG = sum(STL) / G,
BLK_PG = sum(BLK) / G,
TOV_PG = sum(TOV) / G,
MP = sum(MP)) %>%
filter(MP >= 200) %>%
select(-G)
##
players <- player_stat %>%
group_by(player_name) %>%
summarise(G = sum(MP) / min_PG,
PTS_PG = sum(PTS) / G,
REB_PG = sum(TRB) / G,
AST_PG= sum(AST) / G,
STL_PG = sum(STL) / G,
BLK_PG = sum(BLK) / G,
TOV_PG = sum(TOV) / G,
MP = sum(MP)) %>%
filter(MP >= 200) %>%
select(-G)
head(players)
####PREDICTED NET RATING
#new predict variable for expected net rating for each player
players <- mutate(players, exp_NRtg = predict(fit, newdata = players))
players %>%
ggplot(aes(x = exp_NRtg)) +
geom_histogram(binwidth = 0.5, colour = "red", fill = "black")+
theme(panel.background = element_rect(fill = 'black'))
players %>%
ggplot(aes(x = exp_NRtg)) +
geom_histogram(binwidth = 0.5, colour = "red", fill = "black")
##adding player salary
players <- salary %>%
select(player_name, salary) %>%
right_join(players, by = "player_name")
##adding player salary
players <- player_salary %>%
select(player_name, salary) %>%
right_join(players, by = "player_name")
head(players)
##adding player positions
players <- statistics %>%
select(player_name, Pos) %>%
right_join(players, by = "player_name")
##adding player positions
players <- player_stat %>%
select(player_name, Pos) %>%
right_join(players, by = "player_name")
head(players)
####Player recuitment based on the net rating
players %>%
select(player_name, Pos, salary, exp_NRtg) %>%
arrange(desc(exp_NRtg), salary) %>%
top_n(30)
##visualisation
players %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = Pos))+
geom_point()+
xlab("Salary (Millions)")+
theme(legend.position = "bottom")
##visualisation
players %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = Pos))+
geom_point()+
xlab("Salary (Millions)")
##visualisation
players %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = Pos))+
geom_point()+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -10)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -10)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 50,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -10)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -30)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 40,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -25)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 405,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -25)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
######################CENTRE
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C'| Pos == 'C') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 45,as.character(player_name),'')),hjust=1.2,vjust=0.5) +
expand_limits(x = -25)+
theme(legend.position = "none")+
xlab("Salary (Millions)") +
ylab("Expected Net Rating")
#####################POINT GUARD
layers %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 45, y = 75)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
#####################POINT GUARD
players %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 45, y = 75)+
theme(legend.position = "none")+
xlab("Salary (Millions)")  +
ylab("Expected Net Rating")
#####################POINT GUARD
players %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 45, y = 745)+
theme(legend.position = "none")+
xlab("Salary (Millions)")  +
ylab("Expected Net Rating")
#####################POINT GUARD
players %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 45, y = 45)+
theme(legend.position = "none")+
xlab("Salary (Millions)")  +
ylab("Expected Net Rating")
#####################POINT GUARD
players %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 50, y = 45)+
theme(legend.position = "none")+
xlab("Salary (Millions)")  +
ylab("Expected Net Rating")
#####################POINT GUARD
players %>%
filter(Pos == 'PG') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 5,as.character(player_name),'')),hjust=0,vjust=-1) +
expand_limits(x = 60, y = 45)+
theme(legend.position = "none")+
xlab("Salary (Millions)")  +
ylab("Expected Net Rating")
####################SHOOTING GUARD
players %>%
filter(Pos == 'SG' | Pos == 'SG-SF' | Pos == 'PF-SG' | Pos == 'SG-SF') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 4,as.character(player_name),'')),hjust=-0.2,vjust=0.5) +
expand_limits(x = 30)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
####################SHOOTING GUARD
players %>%
filter(Pos == 'SG' | Pos == 'SG-SF' | Pos == 'PF-SG' | Pos == 'SG-SF') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 4,as.character(player_name),'')),hjust=-0.2,vjust=0.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
####################SHOOTING GUARD
players %>%
filter(Pos == 'SG' | Pos == 'SG-SF' | Pos == 'PF-SG' | Pos == 'SG-SF') %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 4,as.character(player_name),'')),hjust=-0.2,vjust=0.5) +
expand_limits(x = 50)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
######################SMALL FORWARD
players %>%
filter(Pos == 'PF-SF' | Pos == 'SF' | Pos == 'SF-SG' | Pos == "SG-SF") %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 10,as.character(player_name),'')),hjust=1.1,vjust=0.5) +
theme(legend.position = "none")+
expand_limits(x = -10)+
xlab("Salary (Millions)")
######################POWER FORWARD
players %>%
filter(Pos == 'C-PF' | Pos == 'PF-C' | Pos == 'PF' | Pos == 'PF-SF' | Pos == "SG-PF") %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, color = player_name)) +
geom_point() +
geom_text(aes(label=ifelse(exp_NRtg > 30,as.character(player_name),'')),hjust=-0.05,vjust=0.5) +
expand_limits(x = 35)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
##########THE STARTING 5
starting_5 <- players %>%
filter(player_name %in% c("Mitchell Robinson", "Giannis Antetokounmpo", "Kawhi Leonard", "Jeremy Lamb", "Michael Carter-Williams")) %>%
arrange(desc(salary))
starting_5
view(starting_5)
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 7, cex = 5) +
theme(panel.background = element_rect(fill = 'red'))+
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 7, cex = 5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 7, cex = 2) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 7, cex = 3) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 7, cex = 2.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 2, cex = 2.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 5, cex = 2.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 6, cex = 2.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
starting_5 %>%
ggplot(aes(x = salary/1000000, y = exp_NRtg, label = player_name)) +
geom_point(colour = "black") +
geom_text(nudge_x = 6.5, cex = 2.5) +
expand_limits(x = 40)+
theme(legend.position = "none")+
xlab("Salary (Millions)")
sum(starting_5$salary)
kable(starting_5[1:5, 1:3]) %>%
kable_styling("striped", full_width = F)%>%
column_spec(1, bold = T)%>%
row_spec(1:5, bold = T, color = "white", background = "#D7261E")
